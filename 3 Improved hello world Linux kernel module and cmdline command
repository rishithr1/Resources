Perfect üëç ‚Äî now we‚Äôll level up from minimal hello module ‚Üí improved / professional hello module.

You asked:

‚ÄúImproved hello world Linux kernel module and cmdline command‚Äù

So I‚Äôll give you:

1Ô∏è‚É£ Improved kernel module code
2Ô∏è‚É£ Extra features added
3Ô∏è‚É£ Line-by-line explanation
4Ô∏è‚É£ Parameter support (very important in BSP)
5Ô∏è‚É£ Proper logging levels
6Ô∏è‚É£ Full Makefile
7Ô∏è‚É£ Build commands
8Ô∏è‚É£ Load / unload commands
9Ô∏è‚É£ Verification commands
üîü Debug commands

This is how engineers actually write test modules.

‚∏ª

1Ô∏è‚É£ Improved Hello World Kernel Module

#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/init.h>
#include <linux/moduleparam.h>

#define DRIVER_NAME "hello_improved"

/* Module parameter */
static char *name = "Engineer";
module_param(name, charp, 0644);
MODULE_PARM_DESC(name, "Name to greet");

/* Init function */
static int __init hello_init(void)
{
    printk(KERN_INFO "[%s] Module Loaded\n", DRIVER_NAME);
    printk(KERN_INFO "[%s] Hello, %s!\n", DRIVER_NAME, name);
    printk(KERN_INFO "[%s] Kernel Version: %s\n", DRIVER_NAME, utsname()->release);
    return 0;
}

/* Exit function */
static void __exit hello_exit(void)
{
    printk(KERN_INFO "[%s] Module Unloaded\n", DRIVER_NAME);
    printk(KERN_INFO "[%s] Goodbye, %s!\n", DRIVER_NAME, name);
}

module_init(hello_init);
module_exit(hello_exit);

/* Metadata */
MODULE_LICENSE("GPL");
MODULE_AUTHOR("V S Rishith Reddy");
MODULE_DESCRIPTION("Improved Hello World Linux Kernel Module");
MODULE_VERSION("1.0");


‚∏ª

2Ô∏è‚É£ What‚Äôs Improved vs Minimal Version

Feature	Minimal	Improved
Logging tag	‚ùå	‚úÖ
Module parameter	‚ùå	‚úÖ
Metadata	Basic	Full
Kernel info print	‚ùå	‚úÖ
Debug clarity	Low	High

This is closer to real driver skeleton.

‚∏ª

3Ô∏è‚É£ New Concept ‚Äî Module Parameter

static char *name = "Engineer";
module_param(name, charp, 0644);

Allows passing values during load.

Example:

sudo insmod hello_improved.ko name=Rishith

Output:

Hello, Rishith!

Used heavily in drivers for config.

‚∏ª

4Ô∏è‚É£ Logging Tagging

#define DRIVER_NAME "hello_improved"

Logs appear as:

[hello_improved] Module Loaded

Helps debugging large systems.

‚∏ª

5Ô∏è‚É£ Kernel Version Access

utsname()->release

Prints running kernel version.

Useful in BSP compatibility debugging.

‚∏ª

6Ô∏è‚É£ Improved Makefile

Create Makefile:

obj-m += hello_improved.o

KDIR := /lib/modules/$(shell uname -r)/build
PWD  := $(shell pwd)

all:
	make -C $(KDIR) M=$(PWD) modules

clean:
	make -C $(KDIR) M=$(PWD) clean


‚∏ª

7Ô∏è‚É£ Build Commands (Cmdline)

Run step-by-step:

‚∏ª

1Ô∏è‚É£ Build module

make

Output:

hello_improved.ko


‚∏ª

2Ô∏è‚É£ Insert module

sudo insmod hello_improved.ko

With parameter:

sudo insmod hello_improved.ko name=SwitchEngineer


‚∏ª

3Ô∏è‚É£ Check module loaded

lsmod | grep hello


‚∏ª

4Ô∏è‚É£ View kernel logs

dmesg | tail -20

Example output:

[hello_improved] Module Loaded
[hello_improved] Hello, SwitchEngineer!
[hello_improved] Kernel Version: 6.x.x


‚∏ª

5Ô∏è‚É£ Remove module

sudo rmmod hello_improved

Check logs again:

Module Unloaded
Goodbye, SwitchEngineer!


‚∏ª

8Ô∏è‚É£ Extra Debug Commands (Very Useful)

‚∏ª

Show module info

modinfo hello_improved.ko

Displays:
	‚Ä¢	Author
	‚Ä¢	License
	‚Ä¢	Description
	‚Ä¢	Version

‚∏ª

Check kernel taint

dmesg | grep taint

Ensures module license valid.

‚∏ª

Auto-load module

sudo modprobe ./hello_improved.ko

(If installed in modules dir)

‚∏ª

9Ô∏è‚É£ Execution Flow Internally

insmod
   ‚Üì
Kernel allocates memory
   ‚Üì
hello_init() runs
   ‚Üì
Logs printed
   ‚Üì
Module active
   ‚Üì
rmmod
   ‚Üì
hello_exit() runs
   ‚Üì
Cleanup done


‚∏ª

üîü Real BSP / Switch Relevance

This skeleton becomes base for:
	‚Ä¢	I¬≤C drivers
	‚Ä¢	EEPROM drivers
	‚Ä¢	Fan controllers
	‚Ä¢	CPLD drivers
	‚Ä¢	ASIC SDK modules

Replace printk ‚Üí hardware logic.

‚∏ª

1Ô∏è‚É£1Ô∏è‚É£ Professional Logging Practice

Real drivers log like:

pr_info("Driver initialized\n");
pr_err("EEPROM read failed\n");
pr_debug("I2C transaction complete\n");

Better than printk.

‚∏ª

1Ô∏è‚É£2Ô∏è‚É£ Memory Shortcut

module_init ‚Üí Load entry
module_exit ‚Üí Unload entry
insmod ‚Üí Insert
rmmod ‚Üí Remove
dmesg ‚Üí Logs
lsmod ‚Üí List modules


‚∏ª

If You Want Next (Driver Progression Path)

Logical next coding steps:

1Ô∏è‚É£ Character driver skeleton
2Ô∏è‚É£ I¬≤C driver example
3Ô∏è‚É£ PCI driver probe/remove
4Ô∏è‚É£ Sysfs interface creation
5Ô∏è‚É£ Interrupt handler module

These are directly used in switch BSP.

‚∏ª

If you want, I can next:
	‚Ä¢	Modify this module to read EEPROM
	‚Ä¢	Add I¬≤C communication
	‚Ä¢	Simulate hardware registers

Just tell üëç
